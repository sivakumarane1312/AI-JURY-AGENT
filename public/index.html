<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Jury Agent | Hackathon PPT Screening Dashboard</title>
    <meta name="description" content="AI-powered hackathon jury agent for automated PPT screening, scoring, and team shortlisting.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-grid"></div>
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>
    <div class="bg-glow bg-glow-3"></div>

    <!-- Top Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-brand">
            <div class="nav-logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <rect width="32" height="32" rx="8" fill="url(#logo-grad)"/>
                    <path d="M10 22L16 10L22 22H10Z" stroke="white" stroke-width="2" fill="none"/>
                    <circle cx="16" cy="18" r="2" fill="white"/>
                    <defs><linearGradient id="logo-grad" x1="0" y1="0" x2="32" y2="32"><stop stop-color="#6366f1"/><stop offset="1" stop-color="#a855f7"/></linearGradient></defs>
                </svg>
            </div>
            <div>
                <h1 class="nav-title">AI Jury Agent</h1>
                <p class="nav-subtitle" id="hackathonName">Loading...</p>
            </div>
        </div>
        <div class="nav-status">
            <div class="status-pill" id="statusPill">
                <span class="status-dot"></span>
                <span id="statusText">Initializing...</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="dashboard" id="tab-dashboard">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
                Dashboard
            </button>
            <button class="tab-btn" data-tab="submissions" id="tab-submissions">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                Submissions
            </button>
            <button class="tab-btn" data-tab="evaluate" id="tab-evaluate">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20V10"/><path d="M18 20V4"/><path d="M6 20v-4"/></svg>
                Evaluate
            </button>
            <button class="tab-btn" data-tab="results" id="tab-results">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                Results & Rankings
            </button>
            <button class="tab-btn" data-tab="shortlist" id="tab-shortlist">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                Shortlist & Email
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div class="tab-content active" id="content-dashboard">
            <div class="section-header">
                <h2>üìä Dashboard Overview</h2>
                <p>Real-time overview of the hackathon screening process</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card" id="stat-total">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #6366f1, #818cf8);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number" id="totalSubmissions">0</span>
                        <span class="stat-label">Total Submissions</span>
                    </div>
                </div>

                <div class="stat-card" id="stat-evaluated">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #34d399);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number" id="totalEvaluated">0</span>
                        <span class="stat-label">Evaluated</span>
                    </div>
                </div>

                <div class="stat-card" id="stat-avg">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #fbbf24);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number" id="avgScore">0.0</span>
                        <span class="stat-label">Avg Score (out of 10)</span>
                    </div>
                </div>

                <div class="stat-card" id="stat-shortlisted">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899, #f472b6);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" y1="22" x2="4" y2="15"/></svg>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number" id="totalShortlisted">0</span>
                        <span class="stat-label">Shortlisted</span>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <h3>üéØ Hackathon Details</h3>
                    <div class="detail-row">
                        <span class="detail-label">Event</span>
                        <span class="detail-value" id="detailHackathon">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Theme</span>
                        <span class="detail-value" id="detailTheme">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Organizer</span>
                        <span class="detail-value" id="detailOrganizer">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Gemini AI</span>
                        <span class="detail-value" id="detailGemini">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Email Service</span>
                        <span class="detail-value" id="detailEmail">-</span>
                    </div>
                </div>

                <div class="card">
                    <h3>üìà Score Distribution</h3>
                    <div class="chart-container" id="scoreChart">
                        <p class="empty-state">No evaluations yet. Start evaluating to see the score distribution.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Submissions Tab -->
        <div class="tab-content" id="content-submissions">
            <div class="section-header">
                <h2>üìã Submissions</h2>
                <p>Load and manage hackathon submissions from Google Forms or manually</p>
            </div>

            <div class="action-bar">
                <button class="btn btn-primary" id="fetchSheetsBtn" onclick="fetchFromSheets()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
                    Fetch from Google Sheets
                </button>
                <button class="btn btn-secondary" onclick="showManualInput()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    Add Manually
                </button>
                <button class="btn btn-secondary" onclick="loadSampleData()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Load Sample Data
                </button>
            </div>

            <!-- Manual Input Modal -->
            <div class="modal-overlay" id="manualInputModal">
                <div class="modal">
                    <div class="modal-header">
                        <h3>Add Submission Manually</h3>
                        <button class="btn-close" onclick="closeModal('manualInputModal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Team Name *</label>
                            <input type="text" id="manualTeamName" placeholder="Enter team name">
                        </div>
                        <div class="form-group">
                            <label>Team Members</label>
                            <input type="text" id="manualMembers" placeholder="Member 1, Member 2, ...">
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="manualEmail" placeholder="team@email.com">
                        </div>
                        <div class="form-group">
                            <label>Project Title *</label>
                            <input type="text" id="manualProjectTitle" placeholder="Enter project title">
                        </div>
                        <div class="form-group">
                            <label>PPT Google Drive Link</label>
                            <input type="url" id="manualDriveLink" placeholder="https://drive.google.com/...">
                        </div>
                        <div class="form-group">
                            <label>Project Description / PPT Content *</label>
                            <textarea id="manualDescription" rows="6" placeholder="Paste the project description, abstract, or PPT text content here..."></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeModal('manualInputModal')">Cancel</button>
                        <button class="btn btn-primary" onclick="addManualSubmission()">Add Submission</button>
                    </div>
                </div>
            </div>

            <!-- Submissions Table -->
            <div class="card" id="submissionsTableCard" style="display: none;">
                <div class="table-wrapper">
                    <table class="data-table" id="submissionsTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Team Name</th>
                                <th>Project Title</th>
                                <th>Email</th>
                                <th>Drive Link</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="submissionsBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="empty-placeholder" id="submissionsEmpty">
                <div class="empty-icon">üìÑ</div>
                <h3>No Submissions Loaded</h3>
                <p>Fetch submissions from Google Sheets, add them manually, or load sample data to get started.</p>
            </div>
        </div>

        <!-- Evaluate Tab -->
        <div class="tab-content" id="content-evaluate">
            <div class="section-header">
                <h2>ü§ñ AI Evaluation</h2>
                <p>Let the AI Jury analyze and score each submission</p>
            </div>

            <div class="evaluate-controls">
                <div class="card">
                    <h3>‚öôÔ∏è Evaluation Settings</h3>
                    <div class="form-group">
                        <label>Hackathon Theme</label>
                        <input type="text" id="evalTheme" value="" placeholder="Theme for evaluation context">
                    </div>
                    <div class="eval-actions">
                        <button class="btn btn-primary btn-lg" id="evalAllBtn" onclick="evaluateAll()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                            Evaluate All Submissions
                        </button>
                        <button class="btn btn-secondary" onclick="clearEvaluations()">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                            Clear All
                        </button>
                    </div>
                </div>
            </div>

            <!-- Progress -->
            <div class="card" id="evalProgressCard" style="display: none;">
                <h3>üìä Evaluation Progress</h3>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="evalProgress" style="width: 0%"></div>
                    </div>
                    <span class="progress-text" id="evalProgressText">0 / 0</span>
                </div>
                <div class="progress-log" id="evalLog"></div>
            </div>

            <!-- Single Evaluation Card -->
            <div class="card">
                <h3>üî¨ Quick Single Evaluation</h3>
                <p class="card-desc">Evaluate a single submission by pasting the content directly</p>
                <div class="form-group">
                    <label>Team Name</label>
                    <input type="text" id="singleTeamName" placeholder="Enter team name">
                </div>
                <div class="form-group">
                    <label>PPT Content / Description</label>
                    <textarea id="singlePptContent" rows="8" placeholder="Paste the PPT content, project description, or abstract here..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="evaluateSingle()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    Analyze with AI
                </button>

                <div class="eval-result" id="singleResult" style="display: none;">
                </div>
            </div>
        </div>

        <!-- Results Tab -->
        <div class="tab-content" id="content-results">
            <div class="section-header">
                <h2>üèÜ Results & Rankings</h2>
                <p>View all evaluated teams ranked by their scores</p>
            </div>

            <div class="action-bar">
                <div class="filter-group">
                    <label>Show Top</label>
                    <select id="topNSelect" onchange="filterResults()">
                        <option value="all">All</option>
                        <option value="5">Top 5</option>
                        <option value="10" selected>Top 10</option>
                        <option value="15">Top 15</option>
                        <option value="20">Top 20</option>
                        <option value="25">Top 25</option>
                    </select>
                </div>
                <button class="btn btn-secondary" onclick="exportResults()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                    Export CSV
                </button>
            </div>

            <div id="resultsContainer"></div>

            <div class="empty-placeholder" id="resultsEmpty">
                <div class="empty-icon">üèÖ</div>
                <h3>No Evaluations Yet</h3>
                <p>Head to the Evaluate tab to start analyzing submissions.</p>
            </div>
        </div>

        <!-- Shortlist Tab -->
        <div class="tab-content" id="content-shortlist">
            <div class="section-header">
                <h2>‚úÖ Shortlist & Notify</h2>
                <p>Select top teams and send shortlist/rejection notifications</p>
            </div>

            <div class="card">
                <h3>üéØ Auto-Select Top Teams</h3>
                <div class="shortlist-controls">
                    <div class="form-group inline">
                        <label>Select Top</label>
                        <input type="number" id="shortlistCount" value="10" min="1" max="100" class="input-sm">
                        <label>teams</label>
                    </div>
                    <button class="btn btn-primary" onclick="autoSelectTop()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                        Auto-Select
                    </button>
                </div>
            </div>

            <div id="shortlistContainer"></div>

            <div class="card" id="emailActionsCard" style="display: none;">
                <h3>üìß Send Notifications</h3>
                <p class="card-desc">Send email notifications to selected teams</p>
                <div class="email-actions">
                    <button class="btn btn-success btn-lg" onclick="sendShortlistEmails()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        Send Shortlist Emails
                    </button>
                    <button class="btn btn-danger" onclick="sendRejectionEmails()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        Send Rejection Emails
                    </button>
                </div>
            </div>

            <div class="empty-placeholder" id="shortlistEmpty">
                <div class="empty-icon">üì®</div>
                <h3>No Teams Shortlisted</h3>
                <p>First evaluate submissions, then auto-select top teams or manually select them from the Results tab.</p>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="app.js"></script>
</body>
</html>
